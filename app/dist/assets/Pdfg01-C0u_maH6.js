import{j as i}from"./index-B7_hvkM2.js";import{P as F,f as L,s as U,a as u,b as y,d as H,c as J,e as _}from"./PdfUtils-2D7kTCyc.js";import{B as m}from"./Button-fInQYk36.js";const g="http://localhost:8080";async function $(e){const n=await F.create();n.registerFontkit(L);const p=n.addPage([595,842]);await U(n);const c=await fetch("/fonts/THSarabunNew Bold.ttf").then(r=>r.arrayBuffer()),s=await n.embedFont(c),l=localStorage.getItem("token");let a;try{const x=await(await fetch(`${g}/api/allRequestExamInfo`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({term:e?.term})})).json();Array.isArray(x)&&x.length>0&&(a=x[0].KQ_exam_date)}catch(r){console.error("Error fetch allRequestExamInfo:",r)}const d={advisor:"advisor_approvals_id",chairpersons:"chairpersons_approvals_id",registrar:"registrar_approvals_id"};try{for(const[r,x]of Object.entries(d)){const v=e?.[x];if(!v||isNaN(Number(v)))continue;const b=await(await fetch(`${g}/api/personnelInfo`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({user_id:v})})).json();b&&(e[x]=b.name)}}catch(r){console.error("Error fetch personnelInfo:",r)}const[h,f,w]=u(e?.request_date),[j,q,B]=u(a),[R,S,T]=y(e?.advisor_approvals_date),[N,P,E]=y(e?.chairpersons_approvals_date),[O,k,D]=y(e?.registrar_approvals_date),[I,C,z]=y(e?.receipt_pay_date);let o=760,t=20;H(p,`คำร้อง${e?.request_type}`,780,s,20),[{text:"มหาวิทยาลัยราชภัฏกำแพงเพชร",x:420,y:o-=t},{text:"วันที่................เดือน...........................พ.ศ...................",x:350,y:o-=t},{text:h,x:380,y:o+2},{text:f,x:440,y:o+2},{text:w,x:510,y:o+2},{text:"เรื่อง",x:60,y:o-=t*2,font:s},{text:e?.request_type,x:100,y:o},{text:"เรียน",x:60,y:o-=t,font:s},{text:`ประธานคณะกรรมการบัณฑิตศึกษาประจำสาขาวิชา${e?.major_name}`,x:100,y:o},{text:"ข้าพเจ้า................................................................................................รหัสประจำตัวนักศึกษา.................................................",x:100,y:o-=t*2},{text:e?.student_name,x:180,y:o+2},{text:e?.student_id,x:460,y:o+2},{text:"ระดับ...........................................หลักสูตร...............................................................................สาขาวิชา....................................................",x:60,y:o-=t},{text:e?.education_level,x:110,y:o+2},{text:e?.program,x:230,y:o+2},{text:e?.major_name,x:440,y:o+2},{text:"คณะ..........................................................................................มีความประสงค์.........................................................................................",x:60,y:o-=t},{text:e?.faculty_name,x:100,y:o+2},{text:`ขอสอบ${e?.request_type}`,x:360,y:o+2},{text:"ในภาคเรียนที่ ....................... ในวันที่.....................................................",x:60,y:o-=t},{text:e?.term,x:130,y:o+2},{text:`${j} ${q} ${B}`,x:210,y:o+2},{text:"จึงเรียนมาเพื่อโปรดพิจารณา",x:100,y:o-=t},{text:"ลงชื่อ...........................................................................",x:310,y:o-=t*2},{text:e?.student_name,x:370,y:o+2},{text:"(.........................................................................)",x:330,y:o-=t},{text:e?.student_name,x:370,y:o+2},{text:"นักศึกษา",x:400,y:o-=t},{text:"วันที่................/........................../......................",x:330,y:o-=t},{text:h,x:360,y:o+2},{text:f,x:400,y:o+2},{text:w,x:465,y:o+2},{text:"1. ความเห็นของอาจารย์ที่ปรึกษาหมู่เรียน",x:60,y:o-=t*2,font:s,show:typeof e?.advisor_approvals=="boolean"},{text:e?.advisor_approvals?"เห็นควรอนุญาต":"ไม่อนุญาต",x:80,y:o-=t,show:typeof e?.advisor_approvals=="boolean"},{text:`เนื่องจาก ${e?.comment}`,x:80,y:o-=t,show:typeof e?.advisor_approvals=="boolean"&&!e.advisor_approvals},{text:"ลงชื่อ.......................................................................",x:75,y:o-=t*2,show:typeof e?.advisor_approvals=="boolean"},{text:e?.advisor_approvals_id,x:140,y:o+2,show:typeof e?.advisor_approvals=="boolean"},{text:"(.....................................................................) ",x:95,y:o-=t,show:typeof e?.advisor_approvals=="boolean"},{text:e?.advisor_approvals_id,x:140,y:o+2,show:typeof e?.advisor_approvals=="boolean"},{text:"อาจารย์ที่ปรึกษา",x:145,y:o-=t,show:typeof e?.advisor_approvals=="boolean"},{text:"วันที่ ........../................./...................",x:110,y:o-=t,show:typeof e?.advisor_approvals=="boolean"},{text:R,x:135,y:o+2,show:typeof e?.advisor_approvals=="boolean"},{text:S,x:170,y:o+2,show:typeof e?.advisor_approvals=="boolean"},{text:T,x:210,y:o+2,show:typeof e?.advisor_approvals=="boolean"},{text:"2. ความเห็นประธานกรรมการบัณฑิตศึกษาประจำสาขาวิชา",x:310,y:o+=t*7,font:s,show:typeof e?.chairpersons_approvals=="boolean"},{text:e?.chairpersons_approvals?"เห็นควรอนุญาต":"ไม่อนุญาต",x:330,y:o-=t,show:typeof e?.chairpersons_approvals=="boolean"},{text:`เนื่องจาก ${e?.comment}`,x:330,y:o-=t,show:typeof e?.chairpersons_approvals=="boolean"&&!e.chairpersons_approvals},{text:"ลงชื่อ.......................................................................",x:325,y:o-=t*2,show:typeof e?.chairpersons_approvals=="boolean"},{text:e?.chairpersons_approvals_id,x:390,y:o+2,show:typeof e?.chairpersons_approvals=="boolean"},{text:"(.....................................................................) ",x:345,y:o-=t,show:typeof e?.chairpersons_approvals=="boolean"},{text:e?.chairpersons_approvals_id,x:390,y:o+2,show:typeof e?.chairpersons_approvals=="boolean"},{text:"ประธานกรรมการบัณฑิตศึกษาประจำสาขาวิชา",x:340,y:o-=t,show:typeof e?.chairpersons_approvals=="boolean"},{text:"วันที่ ........../................./...................",x:360,y:o-=t,show:typeof e?.chairpersons_approvals=="boolean"},{text:N,x:385,y:o+2,show:typeof e?.chairpersons_approvals=="boolean"},{text:P,x:420,y:o+2,show:typeof e?.chairpersons_approvals=="boolean"},{text:E,x:460,y:o+2,show:typeof e?.chairpersons_approvals=="boolean"},{text:"3. การตรวจสอบของสำนักส่งเสริมวิชาการและงานทะเบียน",x:60,y:o-=t*1.5,font:s,show:typeof e?.registrar_approvals=="boolean"},{text:e?.registrar_approvals?`มีสภาพการเป็นนักศึกษา ภาคเรียนที่ ${e?.term}`:"ไม่อนุญาต",x:80,y:o-=t,show:typeof e?.registrar_approvals=="boolean"},{text:e?.registrar_approvals?"ลงทะเบียนเรียนครบตามหลักสูตร":`เนื่องจาก ${e?.comment}`,x:80,y:o-=t,show:typeof e?.registrar_approvals=="boolean"},{text:"ให้ชำระค่าธรรมเนียมที่ฝ่ายการเงิน",x:60,y:o-=t,show:typeof e?.registrar_approvals=="boolean"&&e?.registrar_approvals},{text:"ลงชื่อ.......................................................................",x:75,y:o-=t,show:typeof e?.registrar_approvals=="boolean"},{text:e?.registrar_approvals_id,x:140,y:o+2,show:typeof e?.registrar_approvals=="boolean"},{text:"(.....................................................................) ",x:95,y:o-=t,show:typeof e?.registrar_approvals=="boolean"},{text:e?.registrar_approvals_id,x:140,y:o+2,show:typeof e?.registrar_approvals=="boolean"},{text:"นายทะเบียน",x:150,y:o-=t,show:typeof e?.registrar_approvals=="boolean"},{text:"วันที่ ........../................./...................",x:110,y:o-=t,show:typeof e?.registrar_approvals=="boolean"},{text:O,x:135,y:o+2,show:typeof e?.registrar_approvals=="boolean"},{text:k,x:170,y:o+2,show:typeof e?.registrar_approvals=="boolean"},{text:D,x:210,y:o+2,show:typeof e?.registrar_approvals=="boolean"},{text:`4. ชำระค่าธรรมเนียมการสอบแล้ว ภาคเรียนที่ ${e?.term}`,x:310,y:o+=t*7,font:s,show:e?.receipt_vol!==null},{text:e?.education_level==="ปริญญาโท"?"ปริญญาโท จำนวน 1,000 บาท (หนึ่งพันบาทถ้วน)":"ปริญญาเอก จำนวน 1,500 บาท (หนึ่งพันห้าร้อยบาทถ้วน)",x:330,y:o-=t,show:e?.receipt_vol!==null},{text:`ตามใบเสร็จรับเงิน เล่มที่ ${e?.receipt_vol} เลขที่ ${e?.receipt_No}`,x:310,y:o-=t,show:e?.receipt_vol!==null},{text:"ลงชื่อ.......................................................................",x:325,y:o-=t*2,show:e?.receipt_vol!==null},{text:"นายณัฐวุฒิ มาตกาง",x:390,y:o+2,show:e?.receipt_vol!==null},{text:"(.....................................................................) ",x:345,y:o-=t,show:e?.receipt_vol!==null},{text:"นายณัฐวุฒิ มาตกาง",x:390,y:o+2,show:e?.receipt_vol!==null},{text:"เจ้าหน้าที่การเงิน",x:395,y:o-=t,show:e?.receipt_vol!==null},{text:"วันที่ ........../................./...................",x:360,y:o-=t,show:e?.receipt_vol!==null},{text:I,x:385,y:o+2,show:e?.receipt_vol!==null},{text:C,x:420,y:o+2,show:e?.receipt_vol!==null},{text:z,x:460,y:o+2,show:e?.receipt_vol!==null}].filter(r=>r.show!==!1).forEach(r=>J(p,r.text,r.x,r.y,r.font,r.size)),typeof e?.advisor_approvals=="boolean"&&_(p,50,o+t*8,250,t*8.5),typeof e?.chairpersons_approvals=="boolean"&&_(p,300,o+t*8,250,t*8.5),typeof e?.registrar_approvals=="boolean"&&_(p,50,o-t*.5,250,t*8.5),e?.receipt_vol!==null&&_(p,300,o-t*.5,250,t*8.5);const A=await n.save();return new Blob([A],{type:"application/pdf"})}function M({data:e,showType:n}){const p=async()=>{const s=await $(e),l=URL.createObjectURL(s);window.open(l,"_blank")},c=async()=>{const s=await $(e),l=URL.createObjectURL(s),a=document.createElement("iframe");a.style.display="none",a.src=l,document.body.appendChild(a),a.onload=()=>{a.contentWindow.print()}};return i.jsx(i.Fragment,{children:n==="view"?i.jsx(m,{size:"xs",color:"gray",onClick:p,children:"ข้อมูล"}):i.jsx(m,{size:"xs",color:"blue",onClick:c,children:"พิมพ์"})})}export{M as P};
