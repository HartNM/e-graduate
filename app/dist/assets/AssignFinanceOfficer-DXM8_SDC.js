import{t as l,j as e,A as n,B as F,M,v as k,D as z,T as $,E as V}from"./index-B7_hvkM2.js";import{M as q}from"./ModalInform-NNINQB9X.js";import{u as D}from"./use-form-DDBi_7fX.js";import{G as P}from"./Group-dxvsYpX2.js";import{B as f}from"./Button-fInQYk36.js";import{S as u}from"./Space-CyCyKMgB.js";import{F as G}from"./Flex-CXnzITNo.js";/* empty css                    */import"./createReactComponent-DJN_V7q0.js";const h="http://localhost:8080",Y=()=>{const[c,m]=l.useState({open:!1,type:"",message:""}),d=(s,a)=>m({open:!0,type:s,message:a}),S=()=>m(s=>({...s,open:!1})),[T,o]=l.useState(!1),[i,p]=l.useState(!1),[y,x]=l.useState(!1),j=localStorage.getItem("token"),[v,A]=l.useState([]),[g,w]=l.useState([]),b=[{value:"6000000000001",label:"นายธนกร ศรีสุวรรณ"},{value:"6000000000002",label:"นายปิยะพงษ์ ชาญชัย"},{value:"6000000000003",label:"นางสาวศศิธร บุญเรือง"},{value:"6000000000004",label:"นายอนันต์ รุ่งเรืองสกุล"},{value:"6000000000005",label:"นายกิตติพงษ์ ศรีสวัสดิ์"},{value:"6000000000006",label:"นางสุชาดา แก้วมณี"},{value:"6000000000007",label:"นายธนกฤต พูนสุข"}],r=D({initialValues:{user_id:"",name:"",major_id:"",password:"123456"},validate:{name:s=>s.trim().length>0?null:"กรุณากรอกชื่อ"}});l.useEffect(()=>{(async()=>{try{console.log("candidate :",b);const a=await fetch(`${h}/api/allAssignFinanceOfficer`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`}}),t=await a.json();if(!a.ok)throw new Error(t.message);A(t),console.log("FinanceOfficer :",t);const O=b.filter(C=>!t.some(I=>I.user_id===C.value));w(O),console.log("candidate_filtered :",O)}catch(a){d("error",a.message),console.error("Error fetch allAssignFinanceOfficer:",a)}x(!1)})()},[y]);const E=()=>{r.reset(),p("add"),o(!0)},_=s=>{r.setValues(s),p("delete"),o(!0)},R=async()=>{const s={add:`${h}/api/addAssignFinanceOfficer`,delete:`${h}/api/deleteAssignFinanceOfficer`};try{const a=await fetch(s[i],{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify({...r.values})}),t=await a.json();if(!a.ok)throw new Error(t.message);d("success",t.message),x(!0),o(!1)}catch(a){d("error",a.message),console.error("Error fetch AssignFinanceOfficer:",a)}},B=v.map(s=>e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:s.name}),e.jsx(n.Td,{children:e.jsx(P,{children:e.jsx(f,{color:"red",size:"xs",onClick:()=>_(s),children:"ลบ"})})})]},s.user_id));return e.jsxs(F,{children:[e.jsx(q,{opened:c.open,onClose:S,message:c.message,type:c.type}),e.jsx(M,{opened:T,onClose:()=>o(!1),title:"กรอกข้อมูลประธานกรรมการบัณฑิตศึกษาประจำสาขาวิชา",centered:!0,children:e.jsxs("form",{onSubmit:r.onSubmit(R),children:[i==="delete"?e.jsx(k,{label:"ชื่อ",...r.getInputProps("name"),disabled:!0}):e.jsx(z,{label:"ชื่อ",searchable:!0,data:g,value:r.values.FinanceOfficer_id,onChange:s=>{r.setFieldValue("user_id",s);const a=g.find(t=>t.value===s);r.setFieldValue("name",a?a.label:"")}}),e.jsx(u,{h:"md"}),e.jsx(f,{color:i==="delete"?"red":"green",type:"submit",fullWidth:!0,children:i==="delete"?"ลบ":"บันทึก"})]})}),e.jsx($,{size:"1.5rem",fw:900,mb:"md",children:"AssignFinanceOfficer"}),e.jsx(u,{h:"xl"}),e.jsx(F,{children:e.jsx(G,{justify:"flex-end",children:e.jsx(f,{variant:"filled",size:"xs",onClick:()=>E(),children:"เพิ่มข้อมูล"})})}),e.jsx(u,{h:"xl"}),e.jsx(V,{type:"scroll",offsetScrollbars:!0,style:{borderRadius:"8px",border:"1px solid #e0e0e0"},children:e.jsxs(n,{horizontalSpacing:"sm",verticalSpacing:"sm",highlightOnHover:!0,children:[e.jsx(n.Thead,{children:e.jsxs(n.Tr,{children:[e.jsx(n.Th,{children:"ชื่อ"}),e.jsx(n.Th,{children:"การดำเนินการ"})]})}),e.jsx(n.Tbody,{children:B})]})})]})};export{Y as default};
